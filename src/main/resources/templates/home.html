<!DOCTYPE html>
<html lang="el" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>StreetFoodGo - Î‘ÏÏ‡Î¹ÎºÎ®</title>
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        .status-badge { font-size: 0.7em; padding: 2px 6px; border-radius: 4px; color: white; vertical-align: middle; margin-left: 10px; }
        .status-open { background-color: #28a745; }
        .status-closed { background-color: #dc3545; }
        .store-closed-opacity { opacity: 0.7; }
        .filters-container { background-color: #f1f1f1; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 15px; align-items: center; }
        .filter-group { display: flex; flex-direction: column; }
        .filter-select { padding: 5px; border-radius: 4px; border: 1px solid #ccc; min-width: 150px; }
        .btn-filter { padding: 6px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; height: fit-content; margin-top: auto; }
        .btn-clear { text-decoration: none; color: #666; font-size: 0.9em; margin-top: auto; padding-bottom: 5px; }
    </style>
</head>
<body>
<header>
    <h1>StreetFoodGo</h1>
    <nav>
        <div sec:authorize="!isAuthenticated()">
            <a th:href="@{/login}">Î£ÏÎ½Î´ÎµÏƒÎ·</a> |
            <a th:href="@{/register}">Î•Î³Î³ÏÎ±Ï†Î®</a>
        </div>
        <div sec:authorize="isAuthenticated()">
            <span sec:authentication="name">User</span> |

            <a sec:authorize="hasRole('OWNER')" th:href="@{/owner/dashboard}" style="color: gold; font-weight: bold;">ğŸ›ï¸ Dashboard</a>
            <span sec:authorize="hasRole('OWNER')"> | </span>

            <a sec:authorize="hasRole('CUSTOMER')" th:href="@{/orders/my-orders}">ÎŸÎ¹ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯ÎµÏ‚ Î¼Î¿Ï…</a>
            <span sec:authorize="hasRole('CUSTOMER')"> | </span>

            <a th:href="@{/profile}">Î ÏÎ¿Ï†Î¯Î»</a> |
            <form th:action="@{/logout}" method="post" style="display:inline;">
                <button type="submit" style="background:none; border:none; color:inherit; cursor:pointer; text-decoration:underline; font-size:1em; padding:0;">Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</button>
            </form>
        </div>
    </nav>
</header>

<main>
    <h2>Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÎšÎ±Ï„Î±ÏƒÏ„Î·Î¼Î¬Ï„Ï‰Î½</h2>

    <form th:action="@{/}" method="get" class="filters-container">
        <div class="filter-group">
            <label>Î ÎµÏÎ¹Î¿Ï‡Î®:</label>
            <select name="area" class="filter-select">
                <option value="">ÎŒÎ»ÎµÏ‚ Î¿Î¹ Ï€ÎµÏÎ¹Î¿Ï‡Î­Ï‚</option>
                <option th:each="a : ${areas}" th:value="${a}" th:text="${a}" th:selected="${a == selectedArea}"></option>
            </select>
        </div>
        <div class="filter-group">
            <label>ÎšÎ¿Ï…Î¶Î¯Î½Î±:</label>
            <select name="cuisine" class="filter-select">
                <option value="">ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎ¿Ï…Î¶Î¯Î½ÎµÏ‚</option>
                <option th:each="c : ${cuisines}" th:value="${c}" th:text="${c}" th:selected="${c == selectedCuisine}"></option>
            </select>
        </div>
        <button type="submit" class="btn-filter">Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</button>
        <a th:href="@{/}" class="btn-clear">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</a>
    </form>

    <div th:if="${stores == null or stores.isEmpty()}">
        <p>Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÎºÎ±Ï„Î±ÏƒÏ„Î®Î¼Î±Ï„Î± Î¼Îµ Î±Ï…Ï„Î¬ Ï„Î± ÎºÏÎ¹Ï„Î®ÏÎ¹Î±.</p>
    </div>

    <ul th:unless="${stores == null or stores.isEmpty()}" class="store-list">
        <li th:each="store : ${stores}" class="store-item" th:classappend="${!store.open} ? 'store-closed-opacity'">
            <h3>
                <a th:href="@{/store/{id}(id=${store.id})}" th:text="${store.name}">ÎŒÎ½Î¿Î¼Î±</a>
                <span th:if="${store.open}" class="status-badge status-open">Î‘ÎÎŸÎ™Î§Î¤ÎŸ</span>
                <span th:unless="${store.open}" class="status-badge status-closed">ÎšÎ›Î•Î™Î£Î¤ÎŸ</span>
            </h3>
            <p><strong>Î ÎµÏÎ¹Î¿Ï‡Î®:</strong> <span th:text="${store.area}"></span></p>
            <p><strong>ÎšÎ¿Ï…Î¶Î¯Î½Î±:</strong> <span th:text="${store.cuisineType}"></span></p>
            <p><strong>Î•Î»Î¬Ï‡Î¹ÏƒÏ„Î· Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±:</strong> <span th:text="${store.minOrderAmount}"></span>â‚¬</p>
        </li>
    </ul>
</main>
</body>
</html>